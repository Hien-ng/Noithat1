"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var fs = require("fs");
function getBaseImageName(targetFile) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var contents, results, FROM_RE, match;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    if (!targetFile) {
                        return [2 /*return*/, undefined];
                    }
                    return [4 /*yield*/, readFile(targetFile)];
                case 1:
                    contents = _a.sent();
                    results = [];
                    FROM_RE = /^FROM ([^\s]+)[\s\S]*?$/gim;
                    while (match = FROM_RE.exec(contents)) {
                        results.push(match[1]);
                    }
                    return [2 /*return*/, results.length ? results.pop() : undefined];
            }
        });
    });
}
exports.getBaseImageName = getBaseImageName;
function readFile(path) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        return tslib_1.__generator(this, function (_a) {
            return [2 /*return*/, new Promise(function (resolve, reject) {
                    fs.readFile(path, 'utf8', function (err, data) {
                        return err ? reject(err) : resolve(data);
                    });
                })];
        });
    });
}
//# sourceMappingURL=docker-file.js.map